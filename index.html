<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>北京治安地图</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<meta name="format-detection" content="telephone=no"><!-- 取消格式监察 -->
	<meta name="format-detection" content="email=no">
	<meta name="apple-mobile-web-app-capable" content="yes"><!-- 删除默认的苹果工具栏和菜单栏 -->
	<meta name="apple-mobile-web-app-atatus-bar-style" content="black"><!-- 控制状态栏显示样式 -->
	<meta name="author" content="镝次元实验室（前端by黎晓媚、吴飞黄、刘佳派）">
	<link rel="stylesheet" type="text/css" href="css/animate.min.css" />
	<link rel="stylesheet" type="text/css" href="css/swiper-3.3.1.min.css" />
	<!--标准mui.css-->
    <link rel="stylesheet" href="css/mui.min.css">
    <link href="css/mui.picker.css" rel="stylesheet"/>
    <link href="css/mui.poppicker.css" rel="stylesheet"/>
    <!-- 自定义 -->
    <link rel="stylesheet" type="text/css" href="css/style.css" />

	<script type="text/javascript" src="js/jquery-1.12.3.min.js"></script>
	<script type="text/javascript" src="js/swiper-3.3.1.jquery.min.js"></script>
	<script type="text/javascript" src="js/swiper.animate1.0.2.min.js"></script>
	<script src="js/mui.min.js"></script>
	<script src="js/mui.picker.js"></script>
	<script src="js/mui.poppicker.js"></script>
	<!-- 自定义 -->
	<script type="text/javascript" src="js/xiaomei.js"></script>
	
</head>
<body scroll="no">
<div class="swiper-container">
	<div id="wrapper" class="swiper-wrapper">
		<div class="swiper-slide page1">
			<div class="container">
				<div class="img start_jing ani" swiper-animate-effect="fadeIn" swiper-animate-duration="0.5s" swiper-animate-delay=".3s"></div>
				<div class="img start_10 ani" swiper-animate-effect="fadeIn" swiper-animate-duration="0.3s" swiper-animate-delay=".8s"></div>
				<div class="img start_title ani" swiper-animate-effect="fadeIn" swiper-animate-duration="0.5s" swiper-animate-delay="1.1s"></div>
				<div class="img start_subtitle ani" swiper-animate-effect="fadeIn" swiper-animate-duration="0.5s" swiper-animate-delay="1.6s"></div>
				<div class="img start_car1 ani" swiper-animate-effect="carmove1" swiper-animate-duration="3s" swiper-animate-delay="2.1s"></div>
				<div class="img start_car2 ani" swiper-animate-effect="carmove2" swiper-animate-duration="3s" swiper-animate-delay="2.6s"></div>
				<div class="img start_car3 ani" swiper-animate-effect="carmove3" swiper-animate-duration="3s" swiper-animate-delay="3.1s"></div>
				<div class="img start_next ani" swiper-animate-effect="fadeIn" swiper-animate-duration=".3s" swiper-animate-delay="3.6s"></div>
			</div>
		</div>
		<div class="swiper-slide page2">
			<div class="container">
				<iframe id="iframe" name="map" src="http://www.dyclub.org/projects/pekingSecurity/map/map.html"></iframe>
				<div id="introduction">
					<div class="box">
						<!-- <h3 class="introTitle">北京——居大不易，居安易否？</h3>
						<hr> -->
						<div class="introText">
							<p>北京——居大不易，居安易否？</p>
							<p>小偷是否也和你一样正常“上下班”？骗子喜欢在什么时候给你下套？汽车撬砸案件在哪里频发？抢劫、抢夺犯人最常出现的地点是何处？——我们挖掘2014-2015年北京市公安局每周治安播报数据，试图为你还原一个真实的北京治安状况。</p>
							<p>欲知详情，点击“×”继续查看。</p>
						</div>
					</div>
					<img class="closeBtn" src="http://dyclub-static.oss-cn-qingdao.aliyuncs.com/img/2016/05/pekingSecurity/closeBtn.png">
				</div>

				<div id="operateArea">
					<ul id="mainBtns">
						<li id="caseTypeBtn" class="active"><span>案件类型</span></li>
						<li id="caseTimeBtn"><span>案发时间</span></li>
						<li id="caseAreaBtn"><span>案发区域</span></li>
					</ul>
					<img src="http://dyclub-static.oss-cn-qingdao.aliyuncs.com/img/2016/05/pekingSecurity/blueNextArrow_03.png" class="nextPageBtn">

					<ul id="caseTypes">
						<li data-type="" class="active">总</li>
						<li data-type="入室盗窃">入</li>
						<li data-type="撬砸汽车">撬</li>
						<li data-type="扒窃">扒</li>
						<li data-type="抢劫/抢夺">抢</li>
						<li data-type="拎包盗窃">拎</li>
						<li data-type="诈骗">骗</li>
						<li data-type="盗窃机动车">车</li>
						<li data-type="盗窃非机动车">非</li>
					</ul>
				</div>

				<div id="legend">
					<span class="icon"></span><span class="caseTime">2014-2015年</span><span class="caseType">总体图</span>
				</div>
			</div>
		</div>
		<div class="swiper-slide page3">
			<div class="container">
				<div class="img end_saying ani" swiper-animate-effect="fadeIn" swiper-animate-duration="0.5s" swiper-animate-delay="0.3s"></div>
				<div class="img end_1 ani" swiper-animate-effect="fadeIn" swiper-animate-duration="0.3s" swiper-animate-delay="0.8s"></div>
				<div class="img end_2 ani" swiper-animate-effect="fadeIn" swiper-animate-duration="0.3s" swiper-animate-delay="1.1s"></div>
			</div>
		</div>
	</div>

</div>
	
<script type="text/javascript">

(function (mui, doc) {
        mui.init();
        mui.ready(function () {
            //普通示例
            var userPicker = new mui.PopPicker();
            userPicker.setData([{value: '201401',text: '2014年1月'}, {value: '201402',text: '2014年2月'},
             {value: '201403',text: '2014年3月'}, {value: '201404',text: '2014年4月'},
             {value: '201405',text: '2014年5月'}, {value: '201406',text: '2014年6月'},
             {value: '201407',text: '2014年7月'}, {value: '201408',text: '2014年8月'},
             {value: '201409',text: '2014年9月'}, {value: '201410',text: '2014年10月'},
             {value: '201411',text: '2014年11月'}, {value: '201412',text: '2014年12月'},
             {value: '201503',text: '2015年3月'}, {value: '201504',text: '2015年4月'},
             {value: '201505',text: '2015年5月'}, {value: '201506',text: '2015年6月'},
             {value: '201507',text: '2015年7月'}, {value: '201508',text: '2015年8月'},
             {value: '201509',text: '2015年9月'}, {value: '201510',text: '2015年10月'},
             {value: '201511',text: '2015年11月'}, {value: '201512',text: '2015年12月'},
             {value: '2014',text: '2014年'}, {value: '2015',text: '2015年'},
             {value: '',text: '2014-2015年'}
             ]);
            var showUserPickerButton = doc.getElementById('caseTimeBtn');
            showUserPickerButton.addEventListener('tap', function (event) {
            	$('#mainBtns>li.active').removeClass('active');
            	$('#caseTimeBtn').addClass('active');
            	$('#caseTypes').hide();

                userPicker.show(function (items) {
                	$('#legend>.caseTime').text(items[0].text);
                    map.window.geoq.setTime(items[0].value);
                });
            }, false);
        });
    })(mui, document);

    var geoqStarted = false;

	//swiper.js
	var mySwiper = new Swiper ('.swiper-container', {
	    direction: 'vertical',
	    loop: false,
	    
	    // 如果需要前进后退按钮
	    nextButton: '.swiper-button-next',
	    onInit: function(swiper){ //Swiper2.x的初始化是onFirstInit
	        swiperAnimateCache(swiper); //隐藏动画元素
	        swiperAnimate(swiper); //初始化完成开始动画
	    },
	    onSlideChangeStart: function(swiper){
	    	if (mySwiper.progress == 0.5) {
	    		if(!geoqStarted){
	    			map.window.geoq.start();
	    			geoqStarted = true;
	    		}
	    		
	    	}
	    },
	    onSlideChangeEnd: function(swiper){
	        swiperAnimate(swiper); //每个slide切换结束时也运行当前slide动画
	    }
	})

// 样式调整
	// 设置介绍页内部box div的高，以设置边框外等距边距
	var introHeight = $('#introduction').height();
	$('#introduction>.box').height(introHeight-5*2);
	



	function showIntro(){
		$('#introduction').show();
	}

	// 点击关闭按钮关闭浮层
	$('.closeBtn').click(function(e){
		var target = $(e.target);
		target.parent().fadeOut();

		$('#operateArea').show();
		$('#legend').show();
	})

	// 主按钮，选择类型、时间或区域
	$('#mainBtns').click(function(e){
		var target = $(e.target);
		$('#mainBtns>li.active').removeClass('active');
		target.addClass('active');
		target.parent().addClass('active');
	})
	$('#caseTypeBtn').click(function(){
		$('#caseTypes').show();
	})
	$('#caseAreaBtn').click(function(){
		$('#caseTypes').hide();
	})

	// 案件类型选择
	$('#caseTypes').click(function(e){
		var target = $(e.target);
		$('#caseTypes>.active').removeClass('active');
		target.addClass('active');
		$('#legend>.caseType').text(function(){
			return target.data("type")?target.data("type"):"总体图";
		})
		map.window.geoq.setType(target.data("type"));
	})




	
</script>
</body>
</html>